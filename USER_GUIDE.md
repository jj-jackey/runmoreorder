# 📋 AUTO ORDER CONVERTER 사용법 가이드

자동 발주서 변환 시스템의 완전한 사용법 가이드입니다. 이 시스템을 통해 주문서를 발주서로 자동 변환하고, 이메일로 간편 전송할 수 있습니다.

## 📚 목차

1. [시작하기](#-시작하기)
2. [기본 워크플로우](#-기본-워크플로우)
3. [상세 기능 가이드](#-상세-기능-가이드)
4. [AI 자동 매칭 설정](#-ai-자동-매칭-설정)
5. [관리자 기능](#-관리자-기능)
6. [문제 해결](#-문제-해결)
7. [고급 기능](#-고급-기능)

---

## 🚀 시작하기

**시스템 접속**
웹 브라우저에서 시스템에 접속하세요.
```
https://order.runmoa.ai
```

**초기 설정 확인**
페이지 로드 후 우상단을 확인하세요.

**기본 모드 (API 키 없음):**
- 📋 `수동/템플릿 모드` 표시
- 🔑 `API 키 설정` 버튼

**AI 모드 (API 키 설정됨):**
- 🤖 `AI 기능 사용 가능` 표시

---

## 🔄 기본 워크플로우

### 1️⃣ 작업 모드 선택

#### 📝 파일 업로드 모드 (권장)
- **용도**: 엑셀 파일에서 데이터를 읽어와 자동 처리
- **파일 형식**: `.xlsx`, `.xls`, `.csv`
- **장점**: 대량 데이터 처리, 정확성, 자동화

#### ✏️ 주문서 직접 입력 모드
- **용도**: 소량 데이터를 직접 입력
- **사용 시기**: 테스트, 간단한 주문서

#### 🔧 기본 템플릿 사용 모드
- **용도**: 미리 정의된 템플릿으로 발주서 생성
- **사용 시기**: 표준화된 발주서가 필요한 경우

#### 📄 저장 템플릿 사용 모드
- **용도**: 이전에 저장한 매칭 정보 재사용
- **장점**: 반복 작업 효율성

### 2️⃣ 파일 업로드 (파일 업로드 모드)

#### 주문서 파일 업로드
1. **"주문서 파일 업로드"** 섹션으로 이동
2. **파일 선택** 버튼 클릭
3. 주문서 엑셀 파일 선택 (`.xlsx`, `.xls`, `.csv`)
4. 업로드 완료 후 데이터 미리보기 확인

#### 발주서 파일 업로드  
1. **"발주서 파일 업로드"** 섹션으로 이동
2. **파일 선택** 버튼 클릭
3. 발주서 템플릿 파일 선택
4. 업로드 완료 후 템플릿 구조 확인

### 3️⃣ 매칭 설정

#### AI 자동 매칭
1. **🤖 AI 자동 매칭** 버튼 클릭
2. AI가 자동으로 컬럼 매칭 분석
3. 매칭 결과 검토 및 수정
4. **매칭 저장** 클릭
5. 매칭 취소 하고 싶은 경우 발주서 매칭 부분 다시 클릭
6. 매칭 취소된 경우 주문서 컬럼 제일 아래쪽으로 복귀

#### 수동 매칭
1. 주문서 컬럼 선택
2. 매칭할 발주서 컬럼 클릭
3. **매칭 저장** 클릭
4. 필요시 **"필수필드 수동입력"** 버튼으로 고정값 설정(단, 매칭이 안 된 컬럼만 작성 가능)
	a. 필드추가
	b. 매칭되지 않은 발주서 필드 선택
	c. 공통으로 들어갈 값 입력
	d. 저장

### 4️⃣ 발주서 생성
1. **발주서 생성** 버튼 클릭
2. 진행률 표시를 통해 생성 과정 확인
3. 생성 완료 후 **다운받기, 미리보기, 템플릿 저장** 가능
4. 탬플릿 저장시 탬플릿명은 [쇼핑몰-택배사] 형태 선호 
   ex) 쿠팡-CJ

### 5️⃣ 이메일 전송 (선택사항)
1. **이메일 전송** 섹션 활성화
2. 받는 사람 이메일 주소 입력 필수
3. 제목과 내용 작성
4. **즉시 전송** 또는 **예약 전송** 선택

---

## 🔧 상세 기능 가이드

### 📂 파일 업로드 상세

#### 지원 파일 형식
- **Excel**: `.xlsx`, `.xls` (Excel 2016+ 권장)
- **CSV**: `.csv` (UTF-8 인코딩 권장)
- **최대 크기**: 10MB

#### 파일 업로드 팁
```
✅ 좋은 예시:
- 첫 번째 행에 컬럼명 포함
- 빈 행/열 최소화
- 특수문자 사용 자제

❌ 피해야 할 것:
- 병합된 셀
- 복잡한 수식
- 이미지나 차트 포함
```

### 🔗 매칭 시스템 상세

#### 매칭 유형
1. **자동 매칭**: AI가 컬럼명과 데이터 분석하여 추천
2. **수동 매칭**: 사용자가 직접 클릭으로 선택
3. **직접 입력**: 고정값 입력

#### 매칭 우선순위
```
1. 직접 입력값 (최고 우선순위)
2. 매칭된 주문서 컬럼 데이터
3. 빈 값 (기본값)
```

#### 매칭 저장과 재사용
- **매칭 저장**: 현재 설정을 서버에 저장
- **템플릿 저장**: 나중에 재사용할 수 있도록 저장
- **템플릿 선택, 검색**: 저장된 템플릿 선택 또는 검색 사용

### 📊 데이터 검증

#### 자동 검증 항목
- ✅ **이메일 형식**: `user@domain.com` 패턴 확인
- ✅ **전화번호 형식**: 숫자와 하이픈 조합 확인  
- ✅ **날짜 형식**: 유효한 날짜 형식 확인
- ✅ **필수 필드**: 비어있으면 안 되는 필드 확인

#### 검증 실패 시 대응
```
⚠️ 경고 메시지 예시:
"3행의 이메일 주소가 올바르지 않습니다: invalid-email"
"5행의 날짜 형식을 확인하세요: 2024/13/45"
```

---

## 🤖 AI 자동 매칭 설정

### OpenAI API 키 설정

#### 1단계: API 키 발급
1. [OpenAI Platform](https://platform.openai.com) 접속
2. 계정 로그인 또는 회원가입
3. **"Create new secret key"** 클릭
4. API 키 복사 (`sk-`로 시작하는 긴 문자열)

#### 2단계: 시스템에 API 키 등록
1. 우상단 **🔑 API 키 설정** 버튼 클릭
2. API 키 입력란에 복사한 키 붙여넣기
3. **🚀 시작하기** 버튼 클릭
4. 검증 완료 후 메인 페이지로 자동 이동

#### 3단계: AI 기능 사용
- 우상단이 **🤖 AI 기능 사용 가능**으로 변경됨
- **🤖 AI 자동 매칭** 버튼 활성화
- 더 정확하고 빠른 매칭 가능

### AI 매칭 동작 원리
```
1. 📊 주문서/발주서 컬럼명 분석
2. 🧠 의미와 데이터 유형 파악
3. 🔗 최적의 매칭 관계 추천
4. ✅ 사용자 검토 및 수정 가능
```

### AI 매칭 정확도 향상 팁
- **명확한 컬럼명 사용**: "상품명", "수량", "단가" 등
- **일관된 데이터 형식**: 같은 컬럼 내 동일한 형식 유지
- **샘플 데이터 포함**: 빈 행보다는 실제 데이터가 있는 행

---

## 👨‍💼 관리자 기능 - API 키 사용가능

### 관리자 로그인

#### 로그인 방법
1. 우상단 **🔑 API 키 설정** 버튼 클릭
2. 하단 **관리자 로그인** 섹션으로 스크롤
3. 관리자 계정 정보 입력:
   - **사용자명**: `admin`
   - **비밀번호**: `admin4321` (기본값)
4. **관리자 로그인** 버튼 클릭

---

## 📧 이메일 전송 시스템

### 이메일 설정

#### 기본 정보 입력
```
📧 받는 사람: recipient@company.com
📝 제목: 런모아 202507272237_쿠팡CJ
📄 내용: 안녕하세요. 첨부파일로 발주서를 보내드립니다.
         확인 후 회신 부탁드립니다.
         감사합니다.
```

#### 첨부파일
- ✅ **생성된 발주서**: 자동으로 첨부됨

### 전송 옵션

#### 즉시 전송
- **사용 시기**: 지금 바로 전송이 필요한 경우
- **처리 시간**: 30초 내 전송 완료
- **확인 방법**: 전송 완료 메시지 + 이메일 이력에 기록

#### 예약 전송
- **사용 시기**: 특정 시간에 전송하고 싶은 경우
- **설정 방법**: 날짜와 시간 선택
- **주의사항**: 시스템 시간 기준 (한국 시간)

### 전송 이력 관리

#### 예약된 이메일 관리
1. **📅 예약된 이메일** 섹션에서 확인
2. **예약 취소**: 개별 이메일 예약 취소
3. **일괄 관리**: 여러 예약 이메일 선택하여 일괄 취소

#### 전송 이력 확인
1. **📧 전송 이력** 섹션에서 확인
2. **🔄 새로고침** 버튼으로 최신 이력 조회
3. 각 이메일의 상태 확인:
   - ✅ **성공**: 정상 전송 완료
   - ❌ **실패**: 전송 실패 (이유 확인 가능)
   - ⏳ **진행중**: 전송 처리 중


---

## 🔧 문제 해결

### 자주 발생하는 문제

#### 1. 파일 업로드 실패
```
❌ 문제: "파일 업로드에 실패했습니다"
✅ 해결:
- 파일 크기 10MB 이하 확인
- 지원 형식 (.xlsx, .xls, .csv) 확인
- 파일이 열려있지 않은지 확인
- 브라우저 새로고침 후 재시도
```

#### 2. AI 매칭 오류
```
❌ 문제: "AI 자동 매칭에 실패했습니다"
✅ 해결:
- API 키 설정 확인
- 인터넷 연결 상태 확인
- 파일 데이터가 명확한지 확인
- 수동 매칭으로 대체 사용
```

#### 3. 이메일 전송 실패
```
❌ 문제: "이메일 전송에 실패했습니다"
✅ 해결:
- 이메일 주소 형식 확인
- 첨부파일 크기 확인 (25MB 이하)
- 네트워크 상태 확인
- 잠시 후 다시 시도
```

#### 4. 매칭이 저장되지 않음
```
❌ 문제: "매칭 저장에 실패했습니다"
✅ 해결:
- 모든 필수 매칭 완료했는지 확인
- 브라우저 쿠키/캐시 설정 확인
- 다른 브라우저에서 시도
- 페이지 새로고침 후 재시도
```

### 브라우저별 권장 설정

#### Chrome (권장)
```
✅ 권장 설정:
- JavaScript 활성화
- 쿠키 허용
- 팝업 차단 해제 (해당 사이트)
- 최신 버전 사용
```

#### Safari
```
⚠️ 주의사항:
- 교차 사이트 추적 방지 설정 확인
- ITP(Intelligent Tracking Prevention) 설정
```

#### Firefox
```
✅ 권장 설정:
- 추적 방지 설정을 '표준'으로 변경
- 쿠키 정책 확인
```

### 성능 최적화 팁

#### 대용량 파일 처리
```
📊 권장 사항:
- 1000행 이하: 최적 성능
- 5000행 이하: 양호한 성능  
- 10000행 이상: 파일 분할 권장
```

#### 브라우저 메모리 관리
```
🔄 정기적으로 수행:
- 브라우저 탭 정리
- 캐시 및 쿠키 정리
- 브라우저 재시작
```

---

## 🎯 고급 기능

### Webhook 설정 (관리자 전용)

#### Webhook이란?
시스템에서 특정 이벤트 발생 시 외부 서비스로 자동 알림을 보내는 기능

#### 설정 방법
1. 관리자 로그인
2. **런모아 플랫폼 연동 관리** 섹션으로 이동
3. Webhook URL 입력
4. 알림받을 이벤트 선택
5. **저장** 버튼 클릭

#### 활용 예시
```json
{
  "event": "email_sent",
  "timestamp": "2024-01-15T10:30:00Z",
  "data": {
    "recipient": "user@company.com",
    "subject": "발주서 전송",
    "status": "success"
  }
}
```

### API 직접 사용

#### 이메일 이력 조회 API
```bash
GET /api/example-email-list

응답:
{
  "success": true,
  "count": 50,
  "data": [
    {
      "id": 123,
      "status": "success", 
      "message_id": "msg_abc123",
      "sent_at": "2025-07-15T10:30:00Z"
    }
  ],
  "message": "총 50개의 이메일 이력을 조회했습니다."
}
```

#### 발주서 생성 API
```bash
POST /api/orders/generate
Content-Type: application/json

{
  "fileId": "업로드된_주문서_파일_ID",
  "mappingId": "저장된_매핑_규칙_ID",
  "templateType": "default",
  "supplierFileId": "발주서_템플릿_파일_ID",
  "manualFields": {"추가필드": "값"}
}
```

---

## 📞 지원 및 피드백

### 기술 지원
- 🐛 **오류 신고 및 개선 제안**: 오류 보고 시스템 상세 설명 이용
- ❓ **답변 문의**: 이메일 답변 받기는 연락처 정보가 있을 경우만 가능합니다.

### 오류 신고 버튼을 이용해 주세요
```
📋 문의 정보:
- 오류 제목
- 발생 시간
- 수행하려던 작업
- 오류 메시지 (있는 경우)
```

---

## 📚 부록

### 용어 설명
| 용어        | 설명                      |
| --------- | ----------------------- |
| **주문서**   | 고객이 보낸 주문 정보가 담긴 파일     |
| **발주서**   | 공급업체에 보낼 발주 정보가 담긴 파일   |
| **매칭**    | 주문서 컬럼과 발주서 컬럼을 연결하는 설정 |
| **템플릿**   | 발주서의 기본 구조 및 형식         |
| **AI 매칭** | 인공지능을 활용한 자동 컬럼 매칭      |

---

**📋 AUTO ORDER CONVERTER v1.0**  
*마지막 업데이트: 2025년 7월*

이 가이드가 도움이 되셨나요? 추가 질문이나 개선 제안이 있으시면 언제든 문의해주세요! 🚀 